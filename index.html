<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>The Howdy Boot Line-Dancers</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Friendly fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@500;600&family=Nunito:wght@400;600&display=swap" rel="stylesheet">

  <style>
    :root {
      /* softened, more neutral palette */
      --bg: #fffdfc;
      --primary: #e97588;        /* softened coral-pink */
      --primary-dark: #cc6d7a;
      --secondary: #f2b35c;      /* warm golden */
      --text: #402b3a;
      --muted: #77656f;
      --card: #ffffff;
      --border: #e6d7cb;
      --radius-lg: 20px;
      --radius-md: 14px;
      --shadow-soft: 0 12px 30px rgba(0,0,0,0.08);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: "Nunito", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #fff3f4 0, var(--bg) 52%);
      color: var(--text);
    }

    a {
      color: var(--primary-dark);
      text-decoration: none;
    }
    a:hover { text-decoration: underline; }

    .page {
      max-width: 1080px;
      margin: 0 auto;
      padding: 0 1.25rem 3rem;
    }

    /* Header / Nav */
    header {
      position: sticky;
      top: 0;
      z-index: 10;
      backdrop-filter: blur(14px);
      background: rgba(255, 248, 244, 0.95);
      border-bottom: 1px solid rgba(0,0,0,0.06);
    }

    .nav {
      max-width: 1080px;
      margin: 0 auto;
      padding: 0.6rem 1.25rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
    }

    .brand {
      display: flex;
      align-items: center;
    }

    .brand-logo-link {
      display: inline-block;
    }

    .brand-logo {
      border-radius: 22px;
      background: #fff;
      box-shadow: var(--shadow-soft);
      padding: 0.4rem;
      transition: box-shadow 0.15s ease;
    }

    .brand-logo img {
      display: block;
      height: 110px;   /* more prominent logo */
      width: auto;
      transition: transform 0.15s ease;
    }

    .brand-logo:hover img {
      transform: scale(1.06);
    }

    .nav-links {
      display: flex;
      gap: 0.4rem;
      font-size: 0.9rem;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .nav-links a {
      padding: 0.35rem 0.7rem;
      border-radius: 999px;
      color: var(--text);
    }
    .nav-links a:hover {
      background: rgba(233,117,136,0.12);
      text-decoration: none;
    }

    @media (max-width: 720px) {
      .nav {
        flex-direction: column;
        align-items: flex-start;
      }
    }

    /* Hero */
    .hero {
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(0, 2.2fr);
      gap: 2rem;
      padding-top: 2rem;
      align-items: center;
    }

    @media (max-width: 900px) {
      .hero {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .hero-tagline {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      padding: 0.25rem 0.8rem;
      border-radius: 999px;
      background: #fff2f5;
      border: 1px dashed rgba(242,179,92,0.7);
      font-size: 0.85rem;
      color: var(--muted);
      margin-bottom: 0.75rem;
    }

    .hero h1 {
      font-family: "Baloo 2", cursive;
      font-size: clamp(2rem, 3.2vw, 2.6rem);
      margin: 0 0 0.25rem;
      color: var(--primary-dark);
    }

    .hero-subtitle {
      font-weight: 700;
      font-size: 1rem;
      color: var(--secondary);
      margin-bottom: 0.6rem;
    }

    .hero p {
      margin-top: 0.35rem;
      max-width: 32rem;
      color: var(--muted);
      font-size: 0.98rem;
    }

    .hero-actions {
      margin-top: 1.1rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.6rem;
      align-items: center;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.6rem 1.3rem;
      border-radius: 999px;
      border: 1px solid transparent;
      font-size: 0.92rem;
      font-weight: 600;
      cursor: pointer;
      text-decoration: none;
      transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.1s;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: #fff;
      box-shadow: 0 10px 22px rgba(233,117,136,0.4);
    }
    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 12px 28px rgba(233,117,136,0.5);
      text-decoration: none;
    }

    .btn-secondary {
      background: #fff;
      color: var(--primary-dark);
      border-color: rgba(242,179,92,0.8);
    }
    .btn-secondary:hover {
      background: #fff6ea;
      text-decoration: none;
    }

    .hero-meta {
      margin-top: 0.6rem;
      font-size: 0.85rem;
      color: var(--muted);
    }

    .hero-card {
      background: #fff;
      border-radius: var(--radius-lg);
      border: 1px solid rgba(242,179,92,0.45);
      box-shadow: var(--shadow-soft);
      padding: 1.1rem 1.2rem 1.3rem;
      position: relative;
      overflow: hidden;
    }

    .hero-card::before {
      content: "";
      position: absolute;
      inset: 0;
      background-image:
        radial-gradient(circle at 15% 20%, rgba(255, 240, 191, 0.8) 0, transparent 55%),
        radial-gradient(circle at 80% 80%, rgba(252, 214, 230, 0.85) 0, transparent 50%);
      opacity: 0.7;
      pointer-events: none;
    }

    .hero-card-inner { position: relative; z-index: 1; }

    .hero-card-title {
      font-weight: 700;
      font-size: 1rem;
      margin-bottom: 0.25rem;
      color: var(--primary-dark);
    }

    .hero-card-line {
      font-size: 0.9rem;
      color: var(--muted);
      margin: 0.15rem 0;
    }

    .hero-card-tag {
      margin-top: 0.7rem;
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      padding: 0.2rem 0.7rem;
      border-radius: 999px;
      background: rgba(233,117,136,0.08);
      color: var(--primary-dark);
      font-size: 0.78rem;
      font-weight: 600;
    }

    /* Sections */
    section { margin-top: 2.4rem; }

    .section-heading {
      font-size: 1.3rem;
      margin-bottom: 0.4rem;
    }

    .section-subtitle {
      font-size: 0.9rem;
      color: var(--muted);
      max-width: 32rem;
    }

    .card {
      margin-top: 1rem;
      background: var(--card);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border);
      box-shadow: var(--shadow-soft);
      padding: 1.4rem 1.4rem 1.6rem;
    }

    .embed-wrapper {
      margin-top: 0.85rem;
      border-radius: var(--radius-md);
      overflow: hidden;
      border: 1px solid #f0e0d6;
      background: #fffdf9;
    }

    .embed-wrapper iframe {
      width: 100%;
      border: 0;
      min-height: 500px;
      display: block;
    }

    /* give calendar a bit more height so it doesn't look smushed */
    #calendarFrame {
      min-height: 640px;
    }

    .embed-wrapper.small iframe {
      min-height: 420px; /* a bit shorter so the form doesn't feel endless */
    }

    .gallery-card { text-align: center; }

    .small-note {
      margin-top: 0.5rem;
      font-size: 0.82rem;
      color: var(--muted);
    }

    /* Contact */
    .contact-grid {
      display: grid;
      grid-template-columns: minmax(0, 2.1fr) minmax(0, 2fr);
      gap: 1.5rem;
      align-items: flex-start;
    }

    @media (max-width: 900px) {
      .contact-grid { grid-template-columns: minmax(0, 1fr); }
    }

    .contact-item { font-size: 0.95rem; }

    .contact-label {
      font-weight: 700;
      font-size: 0.9rem;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-bottom: 0.25rem;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      padding: 0.25rem 0.8rem;
      border-radius: 999px;
      border: 1px solid rgba(242,179,92,0.5);
      font-size: 0.8rem;
      color: var(--secondary);
      background: #fff7e8;
      margin-bottom: 0.6rem;
    }

    footer {
      border-top: 1px solid rgba(0,0,0,0.06);
      background: #fff7f2;
      margin-top: 2.5rem;
      padding: 1.2rem 1.25rem 1.8rem;
      font-size: 0.8rem;
      color: var(--muted);
    }

    footer .page { padding-bottom: 0; }

    /* Past events */
    .past-events-grid {
      display: grid;
      gap: 1.2rem;
      margin-top: 1.2rem;
    }

    .past-event-card {
      border-radius: var(--radius-md);
      border: 1px solid rgba(242,179,92,0.35);
      background: #fffdfb;
      padding: 1rem;
      box-shadow: 0 10px 22px rgba(0,0,0,0.05);
    }

    .past-event-header {
      display: flex;
      flex-wrap: wrap;
      align-items: baseline;
      justify-content: space-between;
      gap: 0.4rem 1rem;
    }

    .past-event-title {
      margin: 0;
      font-size: 1.05rem;
      color: var(--primary-dark);
      font-weight: 700;
    }

    .past-event-date {
      font-size: 0.85rem;
      color: var(--muted);
      background: #fff2f5;
      border: 1px solid rgba(233,117,136,0.2);
      padding: 0.2rem 0.65rem;
      border-radius: 999px;
    }

    .past-event-description {
      margin: 0.6rem 0 0.8rem;
      color: var(--muted);
      font-size: 0.95rem;
    }

    .event-gallery {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(90px, 1fr));
      gap: 0.5rem;
    }

    .event-gallery img {
      width: 100%;
      height: 90px;
      object-fit: cover;
      border-radius: 12px;
      border: 1px solid rgba(0,0,0,0.08);
    }

    .past-event-actions {
      margin-top: 0.8rem;
      display: flex;
      gap: 0.6rem;
      flex-wrap: wrap;
    }
  </style>
</head>

<body>
  <header>
    <div class="nav">
      <div class="brand">
        <!-- Logo only, no redundant text -->
        <a href="#top" class="brand-logo-link" aria-label="The Howdy Boot Line-Dancers">
          <div class="brand-logo">
            <img src="images/howdy-boot-logo.png" alt="The Howdy Boot Line-Dancers logo" />
          </div>
        </a>
      </div>
      <nav class="nav-links">
        <a href="#about">About</a>
        <a href="#schedule">Upcoming Events</a>
        <a href="#past-events">Past Events</a>
        <a href="#gallery">Photos</a>
        <a href="#info">Notes from DD</a>
        <a href="#contact">Contact</a>
      </nav>
    </div>
  </header>

  <main class="page">
    <!-- HERO -->
    <section class="hero" id="top">
      <div>
        <div class="hero-tagline" data-content-key="hero_tagline">
          Volunteer-led line dancing for kids &amp; the community
        </div>

        <h1 data-content-key="hero_title">The Howdy Boot Line-Dancers</h1>

        <div class="hero-subtitle" data-content-key="hero_subtitle">
        Learn, laugh, line dance!
        </div>

        <p data-content-key="hero_paragraph">
          The Howdy Boot Line-Dancers is a volunteer group where kids learn fun, age-appropriate
          line dances and then share joy at retirement communities, community events, and local gatherings. There‚Äôs no pressure,
          no competition‚Äîjust movement, music, and kindness.
        </p>

        <div class="hero-actions">
          <a href="#schedule" class="btn btn-primary" data-content-key="hero_cta_primary">
            See Classes &amp; Calendar
          </a>
          <a href="#contact" class="btn btn-secondary" data-content-key="hero_cta_secondary">
            Ask About Hosting
          </a>
        </div>

        <div class="hero-meta" data-content-key="hero_meta">
          100% volunteer-led ‚Ä¢ Community-focused ‚Ä¢ Great for kids who are shy, energetic, or anywhere in between
        </div>
      </div>

      <div class="hero-card">
        <div class="hero-card-inner">
          <div class="hero-card-title" data-content-key="hero_card_title">
            A little kindness in every kick.
          </div>
          <p class="hero-card-line" data-content-key="hero_card_line1">
            Dancers learn simple line dances in a safe, encouraging environment‚Äîno experience needed.
          </p>
          <p class="hero-card-line" data-content-key="hero_card_line2">
            The group visits retirrment communities, community events, and local programs to spread smiles and music.
          </p>
          <p class="hero-card-line" data-content-key="hero_card_line3">
            Instructors volunteer their time so families can focus on showing up, not signing contracts.
          </p>
          <div class="hero-card-tag" data-content-key="hero_card_tag">
            ü§† ‚ÄúKids Kicking with Kindness‚Äù in every step.
          </div>
        </div>
      </div>
    </section>

    <!-- ABOUT -->
    <section id="about">
      <h2 class="section-heading" data-content-key="about_title">About the Group</h2>
      <p class="section-subtitle" data-content-key="about_subtitle">
        A simple idea: teach kids a few fun line dances, then go brighten someone else‚Äôs day.
      </p>

      <div class="card">
        <p data-content-key="about_paragraph1">The Howdy Boot Line-Dancers
are a lively new volunteer group of young performers spreading joy through country line dancing, smiles and kindness! 
The Howdy Boot Line-Dancer‚Äôs group began with a simple idea rooted in heart and community. 
We were looking for a fun and meaningful way for kids to give back and spread kindness throughout the community. 
 Line dancing was already something we personally loved and after holding a line-dancing themed birthday party,, the idea naturally took shape.  The birthday celebration quickly turned into, ‚ÄúWhy don‚Äôt we make this a little line-dancing group?‚Äù  From that moment, The Howdy Boot Line-Dancers were born, bringing kids together to dance, serve others, and share smiles everywhere they go!
The dancers learn simple, upbeat line dances, then perform for retirement communities, community events and local programs, in order to give back with smiles, music and dancing!  



<p data-content-key="about_paragraph2">
        They look forward to continuing to share their dancing hearts with many more audiences in the future!
        </p>
        <p data-content-key="about_paragraph3">
         Happy Feet!
Kind Hearts!
Dancing makes the world a little brighter! </p>
      </div>
    </section>

    <!-- SCHEDULE / CALENDAR -->
    <section id="schedule">
      <h2 class="section-heading" data-content-key="schedule_title">Practices &amp; Events</h2>
      <p class="section-subtitle" data-content-key="schedule_subtitle">
        Practices, outreach visits, and special events are kept up to date in the calendar below.
      </p>

      <div class="card">
        <p data-content-key="schedule_intro">
          Because the group is volunteer-based, times and locations can change with seasons and school schedules. The
          calendar shows the most current plan for practices and performances.
        </p>

        <div class="embed-wrapper">
          <!-- Calendar is loaded via JS with cache-busting so updates appear quickly -->
          <iframe id="calendarFrame" title="Howdy Boot Calendar"></iframe>
        </div>
      </div>
    </section>

    <!-- PAST EVENTS -->
    <section id="past-events">
      <h2 class="section-heading">Past Events</h2>
      <p class="section-subtitle">
        Highlights from recent visits. Each event pulls a mini gallery from our main Google Photos album‚Äîno separate
        albums needed.
      </p>

      <div class="card">
        <p>
          Add new events by dropping photo links into the shared Google Sheet tab for past events. Use a pipe (|)
          between photo URLs so each event can show a small gallery while still keeping everything in one album.
        </p>
        <div id="pastEventsList" class="past-events-grid"></div>
        <div class="small-note" id="pastEventsNote">
          Past event highlights will appear here once the sheet is updated.
        </div>
      </div>
    </section>

    <!-- GALLERY -->
    <section id="gallery">
      <h2 class="section-heading" data-content-key="gallery_title">Photos</h2>
      <p class="section-subtitle" data-content-key="gallery_subtitle">
        A peek at practices, performances, and the smiles shared along the way.
      </p>

      <div class="card gallery-card">
        <p data-content-key="gallery_body">
          We keep our photos in a Google Photos album so it‚Äôs easy to add new pictures after each practice or event.
          Click the button below to open the album in a new tab.
        </p>

        <a
          href="https://photos.app.goo.gl/32WDAnZHoStuUCfs6"
          target="_blank"
          rel="noopener"
          class="btn btn-primary"
        >
          Open Photo Gallery üì∏
        </a>

        <div class="small-note">
          Photos are hosted on Google Photos for simple, volunteer-friendly updates.
        </div>
      </div>
    </section>

    <!-- INFO SHEET / DOC -->
    <section id="info">
      <h2 class="section-heading" data-content-key="info_title">Notes from DD</h2>
      <p class="section-subtitle" data-content-key="info_subtitle">
        The full info sheet below is maintained by DD (the instructor) and covers what families need to know.
      </p>

      <div class="card">
        <p data-content-key="info_intro">
          This document may include what to wear, how to sign up, cost or donation information (if any), expectations
          for dancers, and how outreach visits work.
        </p>

        <div class="embed-wrapper">
          <!-- This iframe is filled with your Google Doc URL via JS so it always pulls fresh content -->
          <iframe id="docFrame" title="Howdy Boot Info Sheet"></iframe>
        </div>
      </div>
    </section>

    <!-- CONTACT + REQUEST FORM -->
    <section id="contact">
      <h2 class="section-heading" data-content-key="contact_title">Contact &amp; Request a Visit</h2>
      <p class="section-subtitle" data-content-key="contact_intro">
        Use the details below to reach the volunteer instructor, or fill out the form to request a visit from the
        Howdy Boot Line-Dancers.
      </p>

      <div class="card contact-grid">
        <!-- Contact info (Sheet-driven) -->
        <div>
          <div class="pill" data-content-key="contact_pill">
            üìç Volunteer-based in your local community
          </div>

          <p data-content-key="contact_paragraph1">
            Interested in having the Howdy Boot Line-Dancers visit your nursing home, church event, or community
            program? Reach out with a few details and we‚Äôll see what might be possible.
          </p>
          <p data-content-key="contact_paragraph2">
            Because everything is volunteer-led, availability can vary‚Äîbut we do our best to say yes when schedules and
            space allow.
          </p>

          <div class="contact-item" style="margin-top:0.8rem;">
            <div class="contact-label" data-content-key="contact_email_label">Email</div>
            <a
              href="mailto:dbcravath@gmail.com"
              data-content-key="contact_email_value"
              data-content-attr="href-text-email"
            >
              dbcravath@gmail.com
            </a>
          </div>

          <div class="contact-item" style="margin-top:0.8rem;">
            <div class="contact-label" data-content-key="contact_phone_label">Phone / Text</div>
            <a
              href="tel:+12403382221"
              data-content-key="contact_phone_value"
              data-content-attr="href-text-tel"
            >
              (240) 338-2221
            </a>
          </div>
        </div>

        <!-- Request form -->
        <div>
          <div class="contact-label" data-content-key="request_form_label">Request the Dancers</div>
          <div class="small-note" data-content-key="request_form_intro">
            Fill out this short form if you‚Äôd like to ask about a visit. The instructor will review requests and follow
            up as availability allows.
          </div>

          <div class="embed-wrapper small" style="margin-top:0.7rem;">
            <iframe
              id="requestFormFrame"
              title="Request the Howdy Boot Line-Dancers"
            ></iframe>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="page" style="padding-bottom:0;">
      <span>¬© <span id="year"></span> The Howdy Boot Line-Dancers.</span>
      &nbsp;<span data-content-key="footer_text">A volunteer group of ‚ÄúKids Kicking with Kindness.‚Äù</span>
    </div>
  </footer>

  <script>
    // ---------- CONFIG: Google URLs ----------
    const SHEET_CSV_URL =
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vSEzDs7LVp6yxuIwme97jEC9akDHKNlmaiH3fmyWMkqlay-CjDa84ElNe0QPUD1LVmuBm4hHGGGlnnF/pub?output=csv";

    const DOC_BASE_URL =
      "https://docs.google.com/document/d/e/2PACX-1vSNt_ilcXbHngA8w2L-T0JfaXIp5daI2EERM9YTFvM5x99z2mPXed7bci2X0aZsViCZAhACFt2rN7cj/pub?embedded=true";

    // Past events CSV (publish a sheet tab with headers: title,date,description,photo_urls,album_url)
    const PAST_EVENTS_CSV_URL =
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vSEzDs7LVp6yxuIwme97jEC9akDHKNlmaiH3fmyWMkqlay-CjDa84ElNe0QPUD1LVmuBm4hHGGGlnnF/pub?output=csv&gid=0";

    // Calendar in agenda/schedule mode instead of month
    const CAL_BASE_URL =
      "https://calendar.google.com/calendar/embed?src=453b90c61605e8533f9997458c308e04805aeb36294e4fbe58824119e2eaaba7%40group.calendar.google.com&ctz=America%2FNew_York&mode=AGENDA";

    // Google Form embed (use embedded=true)
    const FORM_BASE_URL =
      "https://docs.google.com/forms/d/e/1FAIpQLSfIEhMDw1UAejuJvxk04doL1fdBz2dh9MYMFGbkrNpr0n2yfQ/viewform?embedded=true";

    // Footer year
    document.getElementById("year").textContent = new Date().getFullYear();

    // Load Doc, Calendar, and Form with cache-busting for browser caches
    function loadEmbeds() {
      const cacheBust = Date.now();
      const docFrame = document.getElementById("docFrame");
      const calFrame = document.getElementById("calendarFrame");
      const formFrame = document.getElementById("requestFormFrame");

      if (docFrame) {
        docFrame.src = DOC_BASE_URL + "&cb=" + cacheBust;   // Google Doc
      }
      if (calFrame) {
        calFrame.src = CAL_BASE_URL + "&cb=" + cacheBust;   // Google Calendar (agenda view)
      }
      if (formFrame) {
        formFrame.src = FORM_BASE_URL + "&cb=" + cacheBust; // Google Form
      }
    }

    // Load text content from Google Sheet (including contact info)
    async function loadSheetContent() {
      if (!SHEET_CSV_URL) return;

      try {
        const res = await fetch(SHEET_CSV_URL);
        if (!res.ok) throw new Error("Failed to fetch sheet");
        const csvText = await res.text();

        const lines = csvText.split("\n").map(l => l.trim()).filter(Boolean);
        const contentMap = {};
        const startIndex = lines[0].toLowerCase().startsWith("key,") ? 1 : 0;

        for (let i = startIndex; i < lines.length; i++) {
          const raw = lines[i];
          const [rawKey, ...rest] = raw.split(",");
          const key = (rawKey || "").trim();
          const value = rest.join(",").trim();
          if (key) contentMap[key] = value;
        }

        document.querySelectorAll("[data-content-key]").forEach(el => {
          const key = el.getAttribute("data-content-key");
          if (!contentMap[key]) return;
          const value = contentMap[key];
          const attr = el.getAttribute("data-content-attr");

          // Special handling for contact email/phone where we want to update href too
          if (attr === "href-text-email") {
            el.textContent = value;
            el.setAttribute("href", "mailto:" + value);
          } else if (attr === "href-text-tel") {
            el.textContent = value;
            const digits = value.replace(/[^0-9+]/g, "");
            el.setAttribute("href", "tel:" + digits);
          } else {
            el.innerHTML = value;
          }
        });
      } catch (err) {
        console.error("Error loading sheet content:", err);
      }
    }

    function parseCsv(text) {
      const rows = [];
      let current = [];
      let value = "";
      let inQuotes = false;

      for (let i = 0; i < text.length; i++) {
        const char = text[i];
        const next = text[i + 1];

        if (char === "\"") {
          if (inQuotes && next === "\"") {
            value += "\"";
            i++;
          } else {
            inQuotes = !inQuotes;
          }
        } else if (char === "," && !inQuotes) {
          current.push(value);
          value = "";
        } else if ((char === "\n" || char === "\r") && !inQuotes) {
          if (value.length || current.length) {
            current.push(value);
            rows.push(current);
            current = [];
            value = "";
          }
        } else {
          value += char;
        }
      }

      if (value.length || current.length) {
        current.push(value);
        rows.push(current);
      }

      return rows;
    }

    async function loadPastEvents() {
      if (!PAST_EVENTS_CSV_URL) return;

      try {
        const res = await fetch(PAST_EVENTS_CSV_URL);
        if (!res.ok) throw new Error("Failed to fetch past events");
        const csvText = await res.text();
        const rows = parseCsv(csvText).filter(row => row.some(cell => cell.trim()));
        if (!rows.length) return;

        const [headers, ...dataRows] = rows;
        const normalized = headers.map(header => header.trim().toLowerCase());

        const list = document.getElementById("pastEventsList");
        const note = document.getElementById("pastEventsNote");
        if (!list) return;

        list.innerHTML = "";
        let rendered = 0;

        dataRows.forEach(row => {
          const record = {};
          normalized.forEach((key, index) => {
            record[key] = (row[index] || "").trim();
          });

          if (!record.title) return;

          const card = document.createElement("div");
          card.className = "past-event-card";

          const header = document.createElement("div");
          header.className = "past-event-header";

          const title = document.createElement("h3");
          title.className = "past-event-title";
          title.textContent = record.title;

          const date = document.createElement("span");
          date.className = "past-event-date";
          date.textContent = record.date || "Recent event";

          header.append(title, date);

          const description = document.createElement("p");
          description.className = "past-event-description";
          description.textContent = record.description || "";

          const gallery = document.createElement("div");
          gallery.className = "event-gallery";
          const photoUrls = (record.photo_urls || "")
            .split("|")
            .map(url => url.trim())
            .filter(Boolean);

          photoUrls.forEach(url => {
            const img = document.createElement("img");
            img.src = url;
            img.alt = `${record.title} photo`;
            img.loading = "lazy";
            gallery.appendChild(img);
          });

          const actions = document.createElement("div");
          actions.className = "past-event-actions";
          if (record.album_url) {
            const link = document.createElement("a");
            link.href = record.album_url;
            link.target = "_blank";
            link.rel = "noopener";
            link.className = "btn btn-secondary";
            link.textContent = "View the full album";
            actions.appendChild(link);
          }

          card.append(header);
          if (record.description) card.appendChild(description);
          if (photoUrls.length) card.appendChild(gallery);
          if (actions.childElementCount) card.appendChild(actions);

          list.appendChild(card);
          rendered += 1;
        });

        if (note) {
          note.style.display = rendered ? "none" : "block";
        }
      } catch (err) {
        console.error("Error loading past events:", err);
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      loadEmbeds();       // Hook up Google Doc + Calendar + Form
      loadSheetContent(); // Pull all editable text from the Sheet
      loadPastEvents();   // Build past events mini galleries
    });
  </script>
</body>
</html>
